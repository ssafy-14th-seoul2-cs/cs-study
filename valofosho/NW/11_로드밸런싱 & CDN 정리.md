# 🌐 Load Balancing & CDN 정리

## 🚦 1. 로드 밸런싱 (Load Balancing)

### 💡 개념

> 여러 대의 서버에 트래픽(요청)을 효율적으로 분산하여 **서버 과부하를 방지하고**, **가용성과 성능을 향상**시키는 기술.

### ⚙️ 주요 역할

* 트래픽 분산 → 서버 부하 최소화
* 장애 발생 시 정상 서버로 자동 전환 (Failover)
* 서비스의 확장성(Scalability) 확보
* 응답 속도와 처리량(Throughput) 개선

---

### 🧭 동작 방식

1. 사용자가 서비스에 접속 요청
2. 로드밸런서(Load Balancer)가 들어온 요청을 감지
3. 현재 서버들의 상태(Health Check)와 부하를 확인
4. **가장 적절한 서버**로 트래픽을 분배

---

### ⚖️ 로드밸런싱 알고리즘

| 알고리즘                            | 설명                            |
| ------------------------------- | ----------------------------- |
| **Round Robin**                 | 순차적으로 서버에 요청 분배               |
| **Weighted Round Robin**        | 서버별 가중치 부여(성능 좋은 서버에 더 많은 요청) |
| **Least Connection**            | 현재 연결 수가 가장 적은 서버로 분배         |
| **IP Hash**                     | 클라이언트 IP 기반으로 항상 같은 서버로 연결    |
| **Response Time / Custom Rule** | 응답 속도나 커스텀 지표 기반 동적 분배        |

---

### 🧱 로드밸런서 계층별 분류 (OSI Layer)

| 계층 | 종류   | 예시 / 특징                                                          |
| -- | ---- | ---------------------------------------------------------------- |
| L4 | 전송계층 | TCP/UDP 기반, IP+Port만 보고 분배 (e.g., AWS NLB, HAProxy L4)           |
| L7 | 응용계층 | HTTP/HTTPS Header·URL·Cookie 기반 분배 (e.g., AWS ALB, Nginx, Envoy) |

---

### 🧩 로드밸런싱 구성 방식

| 구성 방식        | 설명                                     |
| ------------ | -------------------------------------- |
| **DNS 기반**   | 여러 IP를 DNS에 등록해 도메인 수준 분산              |
| **하드웨어 LB**  | 물리 장비 기반, 대규모 트래픽 처리 (F5, A10 등)       |
| **소프트웨어 LB** | Nginx, HAProxy, Envoy 등 오픈소스 기반        |
| **클라우드 LB**  | AWS ELB, GCP Load Balancer, Azure LB 등 |

---

### 🚨 장애 대응 (Failover & Health Check)

* **Health Check**: 주기적으로 서버 상태 점검 (Ping, HTTP 200 등)
* **Failover**: 비정상 서버 자동 제외 및 재분배
* **Session Persistence(Sticky Session)**: 같은 사용자는 같은 서버로 연결 유지 필요 시 사용

---

## 🌍 2. CDN (Content Delivery Network)

### 💡 개념

> 전 세계에 분산된 **캐시 서버(Cache Server)** 를 통해 사용자에게 **가장 가까운 서버에서 콘텐츠를 제공**하는 기술.

→ 콘텐츠 전송 속도를 빠르게 하고, 원본 서버의 부하를 줄임.

---

### ⚙️ 동작 방식

1. 사용자가 웹페이지 접속
2. DNS가 사용자의 위치에 가장 가까운 **CDN 엣지 서버(Edge Server)** 로 요청 라우팅
3. 엣지 서버가 캐시된 콘텐츠 제공
4. 캐시가 없다면 원본 서버에서 가져와 저장 후 전달

---

### 🧱 CDN 구성 요소

| 구성 요소                  | 설명                          |
| ---------------------- | --------------------------- |
| **Origin Server**      | 원본 콘텐츠가 저장된 서버              |
| **Edge Server (PoP)**  | 지역별로 분산된 캐시 서버              |
| **DNS Routing**        | 사용자 위치에 따라 가장 가까운 엣지 서버로 연결 |
| **Cache Policy (TTL)** | 콘텐츠의 캐시 유지 시간 설정            |

---

### ⚡ CDN의 장점

* 전송 지연(Latency) 감소
* 트래픽 부하 분산 → 서버 부하 감소
* 글로벌 사용자 대상 서비스 품질 향상
* DDoS 완화, HTTPS 인증서 통합 관리 등 보안 강화

---

### 🧭 주요 CDN 제공업체

* **Cloudflare**
* **Akamai**
* **AWS CloudFront**
* **Google Cloud CDN**
* **Azure CDN**
* **Fastly**

---

## 🔍 3. 로드밸런싱 vs CDN 비교

| 구분    | 로드밸런서 (Load Balancer)       | CDN (Content Delivery Network) |
| ----- | --------------------------- | ------------------------------ |
| 목적    | 서버 간 트래픽 분산                 | 콘텐츠 전송 속도 향상                   |
| 위치    | 서비스 내부 (데이터센터, 클라우드 내)      | 사용자 근처 (전 세계 엣지 노드)            |
| 처리 대상 | 동적 요청(API, DB, 트랜잭션 등)      | 정적 콘텐츠(이미지, JS, CSS, 동영상 등)    |
| 주요 기능 | 부하분산, 헬스체크, 세션 유지           | 캐싱, 압축, 지역 라우팅                 |
| 구성 계층 | L4, L7                      | DNS 기반, 애플리케이션 계층              |
| 예시    | AWS ALB/NLB, Nginx, HAProxy | Cloudflare, CloudFront, Akamai |

---

## 🧠 핵심 요약

* **로드밸런싱**: 요청을 여러 서버에 분산시켜 **서버 부하 관리 및 고가용성 보장**
* **CDN**: 콘텐츠를 사용자와 **가장 가까운 캐시 서버**에서 전달하여 **속도 향상 및 트래픽 절감**
* 대규모 서비스에서는 **로드밸런서 + CDN** 조합이 일반적
  → CDN이 전 세계 사용자에게 빠르게 콘텐츠 전달
  → 로드밸런서는 백엔드 서버 부하 분산

---
