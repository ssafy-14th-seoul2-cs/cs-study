# 🌐 NAT / VPN / Firewall 정리

> 네트워크 통신 환경에서 **보안·주소 관리·접속 제어**를 담당하는 핵심 기술  
> - **NAT** : IP 주소 변환  
> - **VPN** : 암호화된 가상 터널 통신  
> - **Firewall** : 접근 및 트래픽 제어

---

## 🔁 1️⃣ NAT (Network Address Translation)

> **내부 사설 IP ↔ 외부 공인 IP** 를 변환하여 인터넷 통신이 가능하게 하는 기술  
> IPv4 주소 고갈 문제 해결과 **보안성 향상**이 주요 목적

---

### 📦 개념 요약

| 항목 | 설명 |
|:--|:--|
| **역할** | 내부 네트워크의 사설 IP를 공인 IP로 변환 |
| **계층** | OSI 3계층 (네트워크 계층) |
| **이유** | IPv4 주소 부족, 내부망 보안 강화 |
| **대표 장비** | 라우터(Router), 방화벽(Firewall) |

---

### 📊 NAT 동작 구조

```

[내부망]
192.168.0.10:5001
↓ (NAT 변환)
공인 IP 121.180.10.25:30000
↓
[인터넷]

```

> NAT 장비는 **IP + Port 번호(트랜스포트 계층 정보)** 까지 이용해  
> 다수의 내부 클라이언트를 하나의 공인 IP로 매핑한다.

---

### 🧩 NAT의 종류

| 구분 | 설명 | 예시 |
|:--|:--|:--|
| **Static NAT (정적)** | 사설 IP ↔ 공인 IP를 1:1로 고정 매핑 | 서버 등 고정 주소 필요 시 |
| **Dynamic NAT (동적)** | 다수의 사설 IP가 공인 IP 풀(Pool)을 공유 | 임시 외부 접속 |
| **PAT (Port Address Translation)** | 여러 내부 IP를 단일 공인 IP로 매핑 (Port 기반 구분) | 가정용 라우터, 회사 게이트웨이 |

---

### 🧠 NAT의 장점과 한계

| 장점 | 한계 |
|:--|:--|
| 공인 IP 절약 | 내부 IP 직접 접근 불가 (서버 운영 어려움) |
| 내부망 보호 (비공개화) | End-to-End 통신 제약 (P2P, 게임 등 문제) |
| 트래픽 관리 용이 | VPN, VoIP 등 특정 프로토콜 호환성 문제 |

---

### 💬 NAT와 포트포워딩(Port Forwarding)
- NAT 환경에서도 외부에서 내부 서버에 접근 가능하게 하는 기술  
- **공인 IP:Port → 내부 IP:Port** 로 수동 매핑

```

공인 IP 121.180.10.25:8080 → 내부 192.168.0.10:80

```

---

## 🔒 2️⃣ VPN (Virtual Private Network)

> **공용 네트워크(인터넷)** 위에 **암호화된 가상 사설망**을 구축하는 기술  
> 외부에서도 내부망처럼 안전하게 통신 가능

---

### 📦 개념 요약

| 항목 | 설명 |
|:--|:--|
| **역할** | 공용망(Internet) 위에서 사설망처럼 안전한 통신 |
| **핵심 기술** | 터널링(Tunneling), 암호화(Encryption), 인증(Authentication) |
| **계층** | OSI 3계층(터널링) ~ 7계층(암호화 프로토콜) |
| **대표 프로토콜** | IPsec, PPTP, L2TP, SSL VPN |

---

### 📊 VPN 구조 예시

```

[사무실 내부망]
10.0.0.0/24
│
▼
┌────────────┐     암호화된 터널(Encrypted Tunnel)     ┌────────────┐
│ VPN Client │ =====================================> │ VPN Server │
└────────────┘                                        └────────────┘
▲                                                 │
│                                                 ▼
원격 근무자                                      내부 DB/파일 서버

```

---

### 🔑 VPN 핵심 구성 요소

| 구성 요소 | 설명 |
|:--|:--|
| **Tunneling** | 데이터 패킷을 캡슐화하여 외부에서 내용이 보이지 않게 함 |
| **Encryption** | 캡슐화된 데이터를 암호화하여 도청 방지 |
| **Authentication** | 사용자/장비의 신원 검증 (ID, 인증서 등) |

---

### 🧠 VPN 종류

| 구분 | 설명 | 예시 |
|:--|:--|:--|
| **Site-to-Site VPN** | 두 네트워크 간 연결 (지사 ↔ 본사) | IPsec VPN |
| **Remote Access VPN** | 개인이 원격으로 접속 | SSL VPN, L2TP |
| **Client-to-Site VPN** | 특정 클라이언트 ↔ 내부망 연결 | 회사 재택근무용 VPN |

---

### 📚 대표 프로토콜

| 프로토콜 | 계층 | 특징 |
|:--|:--|:--|
| **PPTP** | L2 | 단순 구조, 보안 약함 |
| **L2TP** | L2 | PPTP 개선, 자체 암호화 없음 |
| **IPsec** | L3 | 강력한 암호화, 기업망 표준 |
| **SSL VPN** | L7 | 웹 브라우저 기반, 접근성 높음 |

---

### 🔐 VPN의 장점과 단점

| 장점 | 단점 |
|:--|:--|
| 보안성 높음 (암호화) | 속도 저하 (암호화 부하) |
| 원격 근무, 외부 접속 가능 | 초기 설정 복잡 |
| 비용 절감 (전용선 대체) | 인증·키 관리 필요 |

---

## 🧱 3️⃣ 방화벽 (Firewall)

> **네트워크 접근 제어 장치**  
> 미리 정의된 정책에 따라 패킷을 허용하거나 차단함으로써  
> **내·외부 네트워크를 보호**하는 보안 장비

---

### 📦 개념 요약

| 항목 | 설명 |
|:--|:--|
| **역할** | 승인된 트래픽만 통과시키고, 나머지는 차단 |
| **계층** | 주로 OSI 3~4계층 (패킷 필터링), 일부 7계층 (응용 방화벽) |
| **형태** | 하드웨어 / 소프트웨어 모두 존재 |
| **정책 기반** | ACL(Access Control List)에 따라 트래픽 필터링 |

---

### 📊 방화벽 구조 예시

```

[내부망] ─┐
│  허용/차단 정책
▼
┌────────┐
│Firewall│
└────────┘
│
[인터넷]

```

---

### 🧩 방화벽의 동작 방식

| 방식 | 설명 | 계층 |
|:--|:--|:--:|
| **패킷 필터링(Packet Filtering)** | IP, Port, 프로토콜 기반으로 트래픽 허용/차단 | L3~L4 |
| **상태 기반 검사(Stateful Inspection)** | 세션 상태(TCP 연결 여부)를 추적하며 허용 | L4 |
| **프록시(Proxy Firewall)** | 응용 계층 트래픽 분석, 중개 서버 역할 | L7 |
| **차세대 방화벽(NGFW)** | DPI(Deep Packet Inspection), 앱/사용자 단위 제어 | L7 |

---

### 🔑 방화벽 정책 예시

| 규칙 | 조건 | 동작 |
|:--|:--|:--|
| Rule 1 | 내부 → 외부, 포트 80/443 | 허용 (웹 접속 허용) |
| Rule 2 | 외부 → 내부, 포트 22 | 차단 (SSH 접근 금지) |
| Rule 3 | 내부 → 외부, 포트 25 | 허용 (메일 발송) |

---

### 🧠 방화벽의 한계와 발전

| 항목 | 내용 |
|:--|:--|
| **한계** | 암호화된 트래픽(HTTPS) 내부 내용 확인 불가 |
| **보완 기술** | IDS/IPS, NGFW, DLP 등과 통합 운용 |
| **최근 추세** | Zero Trust, Cloud Firewall, WAF(Web Application Firewall) |

---

## 🔍 NAT vs VPN vs Firewall 비교

| 구분 | NAT | VPN | 방화벽 |
|:--|:--|:--|:--|
| **주요 목적** | IP 주소 변환 | 암호화된 가상 사설망 | 접근 제어 및 보안 |
| **계층** | L3 | L3~L7 | L3~L7 |
| **보안성** | 낮음 (기본 보호 수준) | 높음 (암호화) | 높음 (정책 기반 차단) |
| **주요 기능** | 사설 ↔ 공인 IP 변환, 포트 포워딩 | 터널링, 암호화, 인증 | 트래픽 필터링, 정책 제어 |
| **대표 사용처** | 공유기, 라우터 | 기업 VPN, 원격 근무 | 내부망 보호, 외부 침입 차단 |

---

## ✅ 핵심 요약

| 항목 | 요약 |
|:--|:--|
| **NAT** | 사설 IP ↔ 공인 IP 변환, IPv4 절약 및 내부망 보호 |
| **VPN** | 인터넷 위의 암호화된 가상 터널, 안전한 원격 통신 |
| **Firewall** | 정책 기반 접근 제어로 네트워크 보호 |
| **공통점** | 네트워크 경계에서 트래픽 제어·보안 강화 |
| **차이점** | NAT=주소 변환, VPN=암호화 통신, Firewall=접근 제어 |

---

> ✅ **한줄 요약:**  
> - **NAT** : “IP 주소를 바꿔 외부로 나간다”  
> - **VPN** : “공용망 위에 안전한 사설망을 만든다”  
> - **Firewall** : “승인된 것만 들어오게 한다”
```
