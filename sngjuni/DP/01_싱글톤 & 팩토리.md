# 싱글톤 & 팩토리

## 싱글턴 패턴 (Singleton Pattern)

---

**정의**

- **싱글턴 패턴**은 특정 클래스의 **인스턴스를 단 하나만 생성**하고, 이 인스턴스를 전역에서 **공유**할 수 있도록 보장하는 패턴

---

**핵심 내용**

1. **목적**
    - 시스템에서 하나의 **인스턴스만 필요**하고, 이 인스턴스에 **전역 접근**이 필요한 경우 사용
    - 예: **애플리케이션 설정**, **로그 관리 시스템**, **데이터베이스 연결 객체** 등에서 유용
2. **구현 방법**
    - **생성자(Constructor)**를 **private**으로 만들어 외부에서 직접 생성 불가능하게 함
    - 클래스 내부에 **정적 변수**로 인스턴스를 **하나만** 유지하고, 이를 반환하는 **정적 메서드**(`getInstance()`) 제공
3. **특징**
    - 애플리케이션 전역에서 인스턴스의 유일성을 보장
    - **스레드 안전(Thread Safety)**을 고려한 구현 필요
    - **지연 초기화(Lazy Initialization)**를 사용하여 처음 호출될 때만 인스턴스를 생성할 수 있음

---

**예시 - Spring Boot**

```java
import org.springframework.stereotype.Service;

@Service
public class UserService {

    private final UserRepository userRepository;

    // 생성자는 Spring이 자동으로 주입 (Dependency Injection)
    public UserService(UserRepository userRepository) {
        this.userRepository = userRepository;
    }

    // 서비스 메서드 예시
    public User findUserById(Long id) {
        return userRepository.findById(id).orElseThrow(() -> new RuntimeException("User not found"));
    }
}
```

---

**장단점**

- **장점**
    - **글로벌 인스턴스** 관리로 메모리 효율성 향상
    - 인스턴스 생성 비용을 절감할 수 있음
    - 객체가 한 번만 생성되므로 **상태 공유**가 용이
- **단점**
    - **테스트 어려움**: 싱글턴 인스턴스를 **모킹(Mock)**하거나 테스트하기 어려움
    - **전역 상태**를 공유하므로, 다수의 클래스가 인스턴스를 **공유할 경우 의도치 않은 의존성**이 발생할 수 있음

---

## 팩토리 패턴 (Factory Pattern)

---

**정의**

- **팩토리 패턴**은 객체 생성을 **서브클래스**에 위임하여 **객체 생성 방식**을 추상화하는 디자인 패턴
- 객체 생성 로직을 클라이언트 코드에서 분리하고, **다양한 구현체**를 **동적으로 생성**할 수 있게 해줌

---

**핵심 내용**

1. **목적**
    - 객체의 생성 로직을 **클라이언트 코드에서 분리**하고, 객체가 필요할 때 **동적으로** 생성할 수 있도록 도와줌
    - 다양한 클래스의 객체를 **인터페이스를 통해 동일한 방식**으로 생성할 수 있도록 해줌
2. **구현 방법**
    - **팩토리 메서드(Factory Method)**를 정의하여 **객체 생성 로직**을 서브클래스가 구현하도록 함
    - 객체 생성 로직을 **추상화**하여, 클라이언트는 구체적인 클래스의 인스턴스를 알 필요가 없음
    - 예: **Factory Method** 또는 **Abstract Factory Pattern**이 그 일종
3. **특징**
    - **클라이언트와 객체 생성 분리**: 객체의 생성 방법을 변경해도 클라이언트는 영향을 받지 않음
    - 객체 생성 로직을 **하위 클래스에서 구현**하도록 하여 **유연성**과 **확장성**을 제공
    - **의존성 주입**(Dependency Injection)과 결합하여 유용하게 사용됨

---

**예시 - Spring Boot**

```java
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
public class CarFactory {

    @Bean
    public Car createCar() {
        return new Car("Toyota", "Corolla");  // 팩토리 메서드가 객체를 생성
    }
}

class Car {
    private String make;
    private String model;

    public Car(String make, String model) {
        this.make = make;
        this.model = model;
    }

    public void drive() {
        System.out.println("Driving a " + make + " " + model);
    }
}

```

---

**장단점**

- **장점**
    - 객체 생성 로직을 **클라이언트 코드에서 분리**하여, 코드가 **더 깔끔**하고 **유지보수 용이**
    - **객체 생성 방식의 변경이 필요할 때** 클라이언트 코드 수정 없이 팩토리 클래스만 수정하면 됨
    - 객체 생성을 **추상화**하여 다양한 객체를 생성할 수 있음
- **단점**
    - **추가적인 클래스**(팩토리 클래스)가 필요해져서 구조가 복잡해짐
    - **팩토리 클래스**가 복잡해지면 **객체 생성 로직**이 분산되어 관리가 어려워질 수 있음

---

## 관련 면접 질문

- 싱글턴 패턴이란 무엇인가요?
    - 시스템에서 하나의 인스턴스만 생성하고 이를 전역적으로 공유하는 패턴입니다. 예를 들어, 애플리케이션 설정 클래스에서 사용됩니다.
- 싱글턴 패턴을 사용할 때의 단점은 무엇인가요?
    - 전역 상태를 공유하므로 테스트가 어려워지고, 여러 클래스가 인스턴스를 공유하면 의도치 않은 의존성 문제가 발생할 수 있습니다.
- 팩토리 패턴이란 무엇인가요?
    - 객체 생성을 서브클래스에 위임하여, 객체 생성 방식에 대한 추상화를 제공하는 패턴입니다.
- 팩토리 패턴의 장점은 무엇인가요?
    - 객체 생성 로직을 클라이언트 코드에서 분리하고, 다양한 구현체를 동적으로 생성할 수 있어 유연성과 확장성을 제공합니다.