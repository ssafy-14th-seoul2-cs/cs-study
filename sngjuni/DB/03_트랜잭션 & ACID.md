# 트랜잭션 & ACID

### **트랜잭션 (Transaction)**

---

**정의**

- 데이터베이스에서 수행되는 **하나의 논리적 작업 단위(Unit of Work)**
- 여러 개의 연산(SQL 문)이 하나의 트랜잭션으로 묶여 **모두 성공하거나 전부 실패해야 하는 원자적 실행**을 보장함
- 데이터의 **무결성, 일관성, 안정성**을 유지하기 위한 핵심 메커니즘

**핵심 내용**

1. **트랜잭션의 구조와 흐름**
    - `BEGIN` → 여러 SQL 연산 수행 → **COMMIT** 또는 **ROLLBACK**
    - COMMIT: 모든 연산이 성공하면 결과를 DB에 영구 반영
    - ROLLBACK: 오류 발생 시 모든 변경 사항을 되돌림
2. **트랜잭션의 상태 (State)**
    - **Active**: 실행 중
    - **Partially Committed**: 연산은 끝났지만 아직 COMMIT 안 됨
    - **Committed**: 정상 종료 후 변경사항 반영
    - **Failed**: 오류 발생으로 실행 불가능 상태
    - **Aborted**: ROLLBACK으로 복구된 상태
3. **트랜잭션 제어문 (TCL, Transaction Control Language)**
    - `COMMIT`: 변경사항 확정
    - `ROLLBACK`: 변경사항 취소
    - `SAVEPOINT`: 중간 저장점 설정
    - `SET TRANSACTION`: 트랜잭션의 격리 수준(Isolation Level) 설정
4. **격리 수준 (Isolation Level)**
    
    
    | 수준 | 설명 | 발생 가능 문제 |
    | --- | --- | --- |
    | READ UNCOMMITTED | 미완료 데이터 읽기 허용 | Dirty Read |
    | READ COMMITTED | 커밋된 데이터만 읽기 | Non-repeatable Read |
    | REPEATABLE READ | 동일 쿼리 결과 보장 | Phantom Read |
    | SERIALIZABLE | 완전한 순차 실행 | 성능 저하 가능 |

**특징**

- 트랜잭션은 DB를 **일관된 상태로 유지**하기 위한 기본 단위
- 장애 시 **로그(Log)** 와 **복구 시스템(Recovery Manager)** 을 통해 복원 가능
- **동시성 제어(Concurrency Control)** 를 통해 다중 사용자 접근 시 데이터 충돌을 방지

**장단점**

- **장점**
    - 데이터 무결성과 안정성 보장
    - 장애 발생 시 복구 가능
    - 여러 사용자 환경에서도 일관된 결과 제공
- **단점**
    - Lock 경쟁, 교착상태(Deadlock) 발생 가능
    - 긴 트랜잭션은 성능 저하 초래

### **ACID**

---

**정의**

- 트랜잭션이 올바르고 안정적으로 수행되기 위해 지켜야 하는 **4가지 성질** (Atomicity, Consistency, Isolation, Durability)
- ACID는 모든 트랜잭션이 “**정확하고 일관된 상태로 종료**”됨을 보장함

**핵심 내용**

| 특성 | 의미 | 설명 / 예시 |
| --- | --- | --- |
| **Atomicity (원자성)** | “전부 수행되거나 전혀 수행되지 않는다” | 계좌 이체 시 A 계좌 출금만 되고 B 입금 실패 시 전체 취소 |
| **Consistency (일관성)** | 트랜잭션 전후 DB의 무결성 유지 | 제약조건, 데이터 타입, 규칙이 항상 만족 |
| **Isolation (격리성)** | 동시에 실행되어도 결과는 순차 실행과 동일 | 동시 실행 트랜잭션 간 상호 간섭 방지 |
| **Durability (영속성)** | 커밋된 결과는 장애 발생 시에도 보존 | 서버 다운 후에도 완료된 거래 정보 유지 |

**특징**

- ACID는 **트랜잭션 신뢰성의 4대 보장 원칙**
- 대부분의 DBMS는 로그, 체크포인트, 복구 메커니즘으로 ACID를 구현
- 트랜잭션이 많을수록 **Isolation vs Performance** 트레이드오프 발생

**장단점**

- **장점**
    - 데이터의 신뢰성과 정확성 보장
    - 장애 복구 및 무결성 유지 가능
    - 동시성 환경에서도 데이터 안정성 확보
- **단점**
    - 높은 일관성과 격리성을 유지하려면 성능 저하 발생
    - 분산 환경에서는 ACID 보장이 복잡하고 오버헤드 큼

## **관련 면접 질문**

- 트랜잭션이란 무엇이며 왜 필요한가요?
    - 데이터베이스의 논리적 작업 단위, 모든 연산을 하나의 묶음으로 처리해 오류나 장애가 발생해도 데이터의 일관성을 유지하기 위해 필요.
- ACID의 네 가지 특성을 설명해보세요.
    - 원자성은 전부 또는 전무 실행, 일관성은 무결성 유지, 격리성은 트랜잭션 간 간섭 방지, 영속성은 커밋된 결과의 보존
- 커밋과 롤백의 차이를 설명해보세요.
    - COMMIT은 모든 변경사항을 DB에 영구 반영, ROLLBACK은 오류 발생 시 이전 상태로 복구.
- 트랜잭션 격리 수준이란 무엇이며, 왜 조정하나요?
    - 여러 트랜잭션이 동시에 실행될 때 간섭 정도를 제어하는 설정.
    일관성을 높이려면 격리 수준을 높이고, 성능을 중시하면 낮춤.